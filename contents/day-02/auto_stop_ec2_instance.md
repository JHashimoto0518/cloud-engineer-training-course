# EC2インスタンスを自動停止する

## ゴール

## ステップ
1.

## ゴール
- 毎日18:45に自分のインスタンスを自動停止するように設定する

## 使用するAWSのサービス
- Amazon Cloudwatch
	- 運用と監視のサービスです。
	- 今回は、CloudWatch Eventsというスケジューラの機能を使います。
		- Linuxのcronのようなものと思ってください。
	- Linuxのcronと比べたときのメリット
		- 処理を実行するためのサーバーを用意する必要がない
		- できるだけサーバーを減らすことで、クラウドの良さを活かせるシステム基盤になります。

## 設定
### マネジメントコンソールにログインし、Cloudwatchを表示
### ルールの作成
#### ステップ1
![](https://i.imgur.com/AxJc0mg.png)
- インスタンスID
	- 自分のインスタンスのIDを設定する
- スケジュールのCron式
	- 時差が9時間あるので、日本時間の18:45は、GMTでは09:45になる。

#### 12:00追記
- 2回目以降のルール作成では、`既存のロールを使用`を選んで、自分が１回目に作成したロールを選択する

#### ステップ2
![](https://i.imgur.com/hhpLEoJ.png)
- 名前
	- user_idを先頭に付ける

### ルールの変更

## 動作確認　
設定内容は、大きく分けて２つあります。

- 何を実行するか？
	- EC2インスタンスの停止
	- 事前に動作確認が可能
	- Cron式を一時的に変えて、期待通りに動作することを確認する。
- いつ実行するか？
	- 毎日研修終了後
	- 本番運用のスケジュールに変えて、期待通りに動作することを確認する。
